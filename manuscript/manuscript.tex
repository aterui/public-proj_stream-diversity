% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Ecosystem size and complexity dictate riverine biodiversity},
  pdfauthor={Akira Terui; Seoghyn Kim; Christine L. Dolph},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newenvironment{cslreferences}%
  {}%
  {\par}

\title{Ecosystem size and complexity dictate riverine biodiversity}
\author{Akira Terui\footnote{Department of Biology, University of North
  Carolina at Greensboro} \and Seoghyn
Kim\footnotemark[1] \and Christine L. Dolph\footnote{Department of
  Ecology, Evolution and Behavior}}
\date{}

\begin{document}
\maketitle
\begin{abstract}
\textbar This is the abstract.
\end{abstract}

Ecologists have long sought to understand the general drivers of
biodiversity. One of the most robust empirical generalizations in
ecology is the positive relationship between species richness and area,
i.e., the species-area relationship (the SAR)\textsuperscript{1}. In
1921, Arrhenius\textsuperscript{2} formulated the SAR as a power-law
\(S = cA^z\) (\(S\) is the number of species observed in a given
geographic area \(A\)), an equation currently known as the Arrhenius
species-area relationship. Since then, the spatial scaling of species
richness has been observed in nearly all taxonomic
group\textsuperscript{3}, although the underlying mechanisms are still
hotly debated\textsuperscript{4}. The SAR is ubiquitous because multiple
mechanisms produce an apparently similar pattern. Larger ecosystems
typically support more diverse metacommunities due to increased habitat
diversity\textsuperscript{5}, larger metacommunity
size\textsuperscript{4,6}, and/or enhanced colonization
dynamics\textsuperscript{7}. Importantly, the SAR provides the
foundation for global conservation efforts. For example, conservation
ecologists have used the SAR estimates to design marine and terrestrial
protected areas, which currently encompass more than XXX kmÂ² globally.

Many ecosystems, however, possess complex spatial structure that cannot
be represented by area - a dimension referred to as the scale-invariant
complexity\textsuperscript{8,9}. Such complexity is evident in branching
ecosystems, including rivers, trees, and mountain ranges, to name just a
few\textsuperscript{9}. Geomorphic or biological processes generate a
pronounced self-similarity in complex branching patterns such that the
part and the whole look alike\textsuperscript{9}. Even though the
branching structure is independent of spatial scale, it forms a physical
template that dictates habitat diversity and dispersal corridors for
living organisms\textsuperscript{10--12}. Limited, but accumulating
evidence suggests that classical concepts cannot predict ecological
dynamics driven by branching structure\textsuperscript{13--15}, and this
recognition has led to recent developments of spatial theories devoted
to complex branching ecosystems\textsuperscript{15--18}. However, most
research either has explored the consequences of branching complexity
for local variation in species richness or relied on theoretical
arguments with limited replicates of artificial branching networks. At
present, we lack a comprehensive evaluation of how branching complexity,
in combination with ecosystem size, scales biodiversity at the
metacommunity level. Filling this knowledge gap may provide common
ground for achieving successful conservation in spatially complex
ecosystems, where the accelerated species loss threatens the delivery of
ecosystem services.

Here, we hypothesize that ecosystem size and complexity dictate
biodiversity patterns in rivers, a prime example of complex branching
ecosystems. The recurrent merging of diverse streams and rivers produces
larger, ecologically distinct channels, ultimately forming a fluvial
network with fractal branching patterns. As such, the complexity of
branching structure, which we define here as the probability of
branching per unit river distance,\textsuperscript{15,19} should control
the habitat heterogeneity of the ecosystem (habitat diversity per unit
area). Meanwhile, ecosystem size (watershed area) should determine the
metacommunity size and total habitat diversity (area x heterogeneity).
We predict that ecosystem size and branching complexity increase
\(\gamma\) diversity by enhancing either \(\alpha\) and/or \(\beta\)
diversity under different ecological scenarios. The present study
combines theory and statistical analysis of extensive community data to
provide crucial insights into how ecological communities are structured
in complex branching networks.

First, we theoretically analyzed the influences of ecosystem size and
branching complexity on \(\gamma\) diversity. We constructed a general
simulation model of metacommunity dynamics,\textsuperscript{20} in which
50 competing species disperse and spatially interact in a random
branching network. Simulated species with different niche in abiotic
conditions (optimum and width) compete for resources with varied
strengths. For simplicity, other ecological traits, such as dispersal
probability, are assumed to be identical among species. Here, we
depicted branching ecosystems as a spatial network of connected habitat
patches (or a discretized river section; see \textbf{Figure 1}) where
mean environmental conditions at each habitat patch are determined by
two factors: (1) the headwater environments (the most upstream habitat
patch) and (2) local environmental noise. Environmental values at the
headwaters are drawn randomly from a normal distribution and propagates
downstream with local environmental noise (i.e., the spatial
autoregressive process with white noise). These values recurrently `mix'
at confluences considering the relative size of joining tributaries (see
Methods). Therefore, our simulation resembles natural processes of how
branching river networks create diverse habitats in a metacommunity. We
used 32 sets of parameter combinations with varied ecological (dispersal
and competition strength) and landscape scenarios (the environmental
variation at headwaters and the degree of local environmental noise).
Under each scenario, we simulated metacommunity dynamics in 1000
branching networks that have different ecosystem size (the number of
habitat patches: 10 to 150) and complexity (branching probability: 0.01
to 0.99) to examine their effects on species diversity.

Our theoretical analysis yielded results consistent with our prediction.
Ecosystem size and complexity both increased \(\gamma\) diversity under
a realistic landscape scenario (\textbf{Figures 2 and 3}), where the
environmental variation at headwaters (\(\sigma_h\)) is greater than the
degree of local environmental noise
(\(\sigma_l\)).\textsuperscript{15,21} The relationships had a
characteristic of power-law (i.e., linear in a log-log scale) and were
consistent under various ecological scenarios. The strength of
competition and dispersal processes (dispersal distance and probability)
did not change the form of the relationships between \(\gamma\)
diversity and ecosystem properties. Hence, the ecosystem size and
complexity are both expected to increase \(\gamma\) diversity regardless
of ecological scenarios.

Dispersal processes, however, affected underlying mechanisms that
produce the positive effects of ecosystem size and complexity on
\(\gamma\) diversity. We observed a greater contribution of \(\beta\)
diversity (defined as \(\frac{\gamma}{\alpha}\)) to increased \(\gamma\)
diversity when dispersal limitation exists (i.e., species travel short
distances). This pattern reflects significant spatial turnover of
species composition over the branching network. In contrast, once the
dispersal limitation was relaxed (species travel long distances), a
clear increase in \(\alpha\) diversity underpinned the positive
relationships between \(\gamma\) diversity and ecosystem properties. The
results agree with previous predictions that increased dispersal
homogenizes community composition while enhancing local diversity
through increased immigrants from suitable habitat patches (i.e., mass
effects). These patterns were consistent across different levels of
dispersal probabilities (\textbf{cite SI figure}). The strength of
competition decreased maximum levels of \(\alpha\) diversity but did not
change the functional forms of the scaling relationships with ecosystem
properties (\textbf{Figures 2 and 3}). In summary, our theory highlights
how the apparently similar patterns in \(\gamma\) diversity emerges
through different ecological pathways.

Influences of ecosystem size and complexity differed significantly in
their dependence on landscape scenarios. Ecosystem size had positive
effects on \(\gamma\) diversity regardless of landscape scenarios,
although the slopes were steeper with greater environmental variation
(higher \(\sigma_h\) and/or \(\sigma_l\)). This result is attributable
to the fact that larger ecosystems can hold more individuals in a
metacommunity\textsuperscript{6}. In contrast, we observed limited or no
influences of branching complexity when local environmental noise was
equal to or exceeded environmental variation at headwaters
(\(\sigma_l \ge \sigma_h\)). Under this scenario, having more branches
may not contribute to the habitat diversity in the ecosystem because
local environmental noise masks environmental differences between
branches. Therefore, this landscape scenario decouples the intimate
relationship between branching structure and habitat diversity, thereby
eliminating the positive effect of branching complexity on \(\gamma\)
diversity. This theoretical prediction may not apply to pristine to
semi-natural river networks where individual streams with diverse
geological and/or climatic backgrounds show distinct environmental
conditions, including water temperature, water chemistry, substrate, and
flow/sediment regimes. Instead, it may be more relevant to severely
altered landscapes where human disturbance compromises the environmental
distinctiveness of each branch through, for example, flow regulations by
dams. Hence, our theory has important implications for riverine
biodiversity conservation by pointing the crucial role of habitat
diversity produced by branching structure\textsuperscript{22}.

The proposed theory provided important insights into how ecological
communities are structured in branching networks; however, empirically
testing the predictions is extremely difficult because it requires
metacommunity-level replications. To confront this logistical challenge,
we compiled existing community data of fishes from a variety of sources
and developed a unique large dataset that spans across two geographic
regions: the Hokkaido island in Japan and the Midwest in the United
States. These regions are located in comparable ranges of latitude but
support distinct fish communities. Therefore, this dataset provides an
excellent opportunity to examine the generality of our theoretical
predictions. After careful data selection, we estimated \(\alpha\),
\(\beta\), and \(\gamma\) diversity (asymptotic species richness;
Methods) at 181 watersheds (60 in Hokkaido and 121 in Midwest), each of
which comprised \(\ge\) 10 sites of presence-absence fish community data
(a total of 6608 sites). Individual watersheds, i.e., metacommunity
replicates in our analysis, were considered as separated if they flow
into one of the following: the ocean, a large lake (\(\ge\) 10 kmÂ² in
the areal area) or a large river that may represent lentic habitats
(\(\ge\) 5000 kmÂ² in the watershed area). We combined this dataset with
geospatial information (watershed area, branching probability, annual
mean temperature, annual cumulative precipitation, and percent forest)
to examine potential influences of macro-scale drivers of species
diversity. Using this dataset, we developed global and region-specific
models for each of diversity measures (\(\alpha\), \(\beta\), and
\(\gamma\) diversity) to examine whether observed patterns are
consistent across the two geographic regions. In the global model, we
assumed that effects of ecosystem size (watershed area) and complexity
(branching probability) are constant across the two regions (i.e., fixed
slopes). Meanwhile, the region-specific model assumes region-specific
slopes of ecosystem size and complexity by including interaction terms
with the dummy binary variable of region (Hokkaido = 0; Midwest = 1). We
compared the performance of these competing models using the Bayes
factor, a measure of the strength of evidence in favor of one model over
the alternative.

Despite the substantial difference in fish fauna between the study
regions, the estimated Bayes factor in favor of the global model
explaining \(\gamma\) diversity was 159.7; this result strongly supports
the consistent effects of ecosystem size and complexity on \(\gamma\)
diversity across the two biogeographic regions. Further, we found
patterns consistent with our theoretical predictions. The estimated
\(\gamma\) diversity increased with increasing watershed area (ecosystem
size) and branching probability (ecosystem complexity) across
watersheds. These effects remained significant even after controlling
for the potential influences of other environmental factors
(precipitation, temperature, and land use). Overall, our statistical
analysis provides strong empirical evidence that ecosystem size and
complexity jointly, but independently, scale riverine biodiversity at
the metacommunity level.

Similarly, we found weak to moderate supports for the global models
explaining observed patterns of \(\alpha\) and \(\beta\) diversity
(Bayes factor: 1.8 and 9.6, respectively). In both regions, \(\beta\)
diversity responded significantly to ecosystem size and complexity. In
our simulations, this pattern has emerged under the scenarios with
dispersal limitation, which elegantly match the previous observations of
stream fish movement. Direct (mark-recapture) and indirect observations
(e.g., genotyping) recurrently revealed restricted movement of stream
fish, typically limited to several tens to hundreds of meters in
distance\textsuperscript{23--25}. The reciprocal agreement of
theoretical and empirical patterns provides indirect but convincing
evidence that dispersal limitation plays a key role in driving the
associations between \(\gamma\) diversity and ecosystem properties in
rivers.

The consistent effect of branching probability on \(\gamma\) diversity
across the study regions is noteworthy because the watersheds in the
Midwest are severely altered by agriculture (median \% agricultural land
use: 66\% for Midwest and 2\% for Hokkaido). If the intensive land use
by humans causes significant homogenization of in-stream habitat
conditions among tributaries, theory predicts weakened effects of
branching probability on \(\gamma\) diversity. However, \(\gamma\)
diversity increased significantly with increasing branching probability
in this highly modified landscape, suggesting that tributaries still
sustain unique environmental conditions to support high spatial trunover
of species composition. In support of this interpretation, \(\beta\)
diversity increased with increasing branching probability in both
regions (\textbf{Figure 4}). It is conceivable that local geological and
geomorphological differences, such as slope, aspect, and soil porosity,
still persist in human-dominated landscapes to maintain diversity of
in-stream processes among tributaties\textsuperscript{26}. Although our
analysis is correlative and cannot provide conclusive evidence, the
finding is encouraging because branching complexity of river networks
may serve as a natural defense system to human-induced environmental
changes.

There may be confounding factors that are not incorporated in our
statistical models. However, we are confident on our statistical
inference because the observed patterns were fairly consistent with our
theoretical predictions that are free from any confounding effects.
Further, our fitted models generally showed high R\textsuperscript{2}
values (\(\alpha\) diversity: 0.8; \(\beta\) diversity, 0.27; \(\gamma\)
diversity 0.77) with no signs of spatial autocorrelation in residuals.
Therefore, it is very unlikely that our results were driven by spurious
correlations.

The emerging complexity-diversity relationship points to several
important avenues for riverine biodiversity conservation. First and
foremost, there is now a clear need to explicitly consider the dimension
of ecosystem complexity to achieve successful conservation. Human
alterations, including flow regulation\textsuperscript{27}, habitat
fragmentation, and stream burial, may compromise or restrict access to
the diverse habitats that complex branching networks may provide. Hence,
it is imperative to recognize the role of branching complexity and
minimize the homogenizing effects of human alterations. Second, the
complexity perspective may provide viable options to reconcile conflicts
between biodiversity conservation and societal needs. Although protected
areas spearhead global conservation efforts, habitat preservation and
restoration over large areas are often impractical because of conflicts
with stakeholders. This is particularly true for riverine ecosystems,
where numerous stakeholders are involved within a single watershed and
enormous efforts are required to reach consensus\textsuperscript{28}. In
such a scenario, spatial planning of small-scale conservation, such as
restoration of connectivity to small tributaties, may be critical to
enhancing the `realized' network complexity that organisms may
experience. Our theoretical framework may be used to design spatial
arrangement of small-scale conservation that improves ecological
outcomes at the metacommunity level.

While the prevailing evidence supports the importance of ecosystem size
in scaling species diversity, ecosystem complexity - especially
branching structure - has not received the attention it deserves.
Ecosystems are inherently complex in its spatial structure, providing a
physical template that creates a wide spectrum of niche opportunities
for living organisms. Hence, our findings should be broadly applicable
to many taxa and ecosystems, and robust generalization of this
complexity perspective is a frontier for future research.

\hypertarget{methods}{%
\section{Methods}\label{methods}}

\hypertarget{theoretical-branching-networks}{%
\subsection{Theoretical branching
networks}\label{theoretical-branching-networks}}

We depicted branching ecosystems as a spatial network of connected
habitat patches. Habitat patches can be either non-branching or
branching river sections with a unit length \(l\), which defines the
scale of local species interactions. Two parameters determine geometric
properties of simulated branching networks: the number of habitat
patches \(N_p\) (ecosystem size) and branching probability \(P_b\)
(ecosystem complexity). Each habitat patch is assigned to be a branching
patch (including upstream terminals) with probability \(P_b\) or
non-branching patch with probability \(1-P_b\). In this framework, an
individual branch is a consecutive series of non-branching patches
terminated at a branching patch; therefore, the number of habitat
patches in a single branch \(n_b\) is a realization of a random variable
drawn from a geometric distribution \(n_{b} \sim Ge(P_{b})\). This
representation has two merits. First, it reflects observed patterns of
branch length distribution, which is known to follow an exponential
distribution (a continuous version of a geometric distribution). Second,
it preserves the fractal nature of branching patterns that is intimately
linked to branching probability. There are other metrics to simulate
fluvial networks; however, our framework is most appropriate in this
study because it allows us to directly test the relationship between
biodiversity patterns and ecosystem properties (ecosystem size and
complexity).

The long-term average of abiotic environment \(\mu_z\) at each habitat
patch is characterized by two sources of variation: environmental
variation at headwaters (\(\sigma_h\)) and local environmental noise
(\(\sigma_l\)). We draw random values from a normal distribution with a
mean of zero and SD of \(\sigma_{h}\) and assigned them to headwater
patches (i.e., the most upstream patches). These environmental values at
headwaters propagate downstream through a spatial autoregressive process
defined as:

\[
\mu_{z,k} = \rho \mu_{z,k+1} + \epsilon_{k}
\]

where \(\mu_{z,k}\) is the environmental value at longitudinal position
\(k\) (\(k\) is the network distance from the outlet patch; \(k = 1\) at
the outlet), \(\rho\) is the strength of spatial autocorrelation and
\(\epsilon_k\) is the local environmental noise that follows a normal
distribution with a mean of zero and SD of \(\sigma_l\). The parameter
\(\rho\) can take values of \(0-1\) with larger values indicating
greater spatial autocorrelation. In this study, we set \(\rho = 1\) to
mimic strong spatial autocorrelation in rinverine environments. At
confluences, we took a weighted mean of environmental values given the
relative size of upstream contributing area of joining tributaries:

\[
\begin{align}
\mu_{z,k} &= \omega(\rho \mu_{z,k+1}^R + \epsilon_{k}^R) + (1-\omega)(\rho \mu_{z,k+1}^L + \epsilon_{k}^L) \\
\omega &= \frac{A_{k+1}^R}{A_{k+1}^R + A_{k+1}^L}
\end{align}
\] where \(R\) and \(L\) denote ``right'' and ``left'' branches,
respectively, and \(A_k\) is the number of upstream habitat patches at
patch \(k\). With this expression, larger tributaties have a greater
influence on the downstream environment, as observed in natural river
networks\textsuperscript{26}.

\hypertarget{metacommunity-model}{%
\subsection{Metacommunity model}\label{metacommunity-model}}

We simulated metacommunity dynamics in simulated branching river
networks. The metacommunity dynamics are described as a function of
local community dynamics and dispersal, following Thompson et
al.\textsuperscript{20}. Specifically, the realized number of
individuals \(N_{ix}(t + 1)\) (species \(i\) at patch \(x\) and time
\(t+1\)) is given as:

\[
N_{ix}(t + 1) \sim Poisson(n_{ix}(t) + I_{ix}(t) - E_{ix}(t))
\] where \(n_{ix}(t)\) is the expected number of individuals given the
local community dynamics at time \(t\), \(I_{ix}(t)\) the expected
number of immigrants to patch \(x\), and \(E_{ix}(t)\) the expected
number of emigrants from patch \(x\). The realized discrete number of
individuals is drawn from a Poisson distribution to account for
stochasticity in demographic and dispersal processes. Local community
dynamics are simulated based on the Beverton-Holt equation:

\[
n_{ix}(t) = \frac{N_{ix}(t)r_{ix}(t)}{1 + \frac{r_{0,i}-1}{K_{x}}\sum_{j=1}^S{\alpha_{ij}N_{jx}(t)}}
\]

where \(r_{ix}(t)\) is the reproductive rate of species \(i\) given the
environmental condition at patch \(x\) and time \(t\), \(r_{0,i}\) the
maximum reproductive rate of species \(i\), \(K_{x}\) the carrying
capacity at patch \(x\), \(\alpha_{ij}\) the interaction coefficient
between species \(i\) and \(j\), and \(S\) the number of species in a
metacommunity. The parameter \(\alpha_{ij}\) was expressed as the
strength of interspecific competition relative to that of intraspecific
competition such that interspecific competition is greater than
intraspecific competition if \(\alpha_{ij}\) \textgreater{} 1
(intraspecific competition coefficient \(\alpha_{ii} = 1\)). The
density-independent reproductive rate \(r_{ix}(t)\) is affected by
abiotic environments (non-consumable) and determined by the following
Gaussian function:

\[
r_{ix}(t) = cr_{0,i}~exp[{-\frac{(\mu_i-z_x(t))^2}{2\sigma^2_{niche,i}}}]
\] where \(\mu_i\) is the optimal environmental value for species \(i\),
\(z_x(t)\) the environmental value at patch \(x\) and time \(t\), and
\(\sigma_{niche}\) the niche width of species \(i\). The cost of having
wider niche is expressed by multiplying \(c\)\textsuperscript{29}:

\[
c = exp(-\frac{\sigma_{niche,i}^2}{2\nu^2})
\]

Smaller values of \(\nu\) imply greater costs of having wider niche
(i.e., decreased maximum reproductive rate). There is no cost if \(\nu\)
approaches infinity.

The environmental value \(z_x(t)\) is assumed to follow a multivariate
normal distribution as \(z_{x}(t) \sim MVN(\mu_z, \Omega_z)\). \(\mu_z\)
is the vector of mean environmental conditions of patches and
\(\Omega_z\) is the variance-covariance matrix. Spatial autocorrelation
in temporal environmental dynamics is considered by expressing the
off-diagonal elements as:

\[
\Omega_{xy} = \sigma_z^2~exp(-\phi d_{xy})
\]

where \(\Omega_{xy}\) denotes the temporal covariance of environmental
conditions between patch \(x\) and \(y\), which is assumed to decay
exponentially with increasing distance between the patches \(d_{xy}\).
The parameter \(\phi\) determines the degree of distance decay of
environmental correlates.

The expected number of emigrants at time \(t\) is the product of
dispersal probability \(p_d\) and \(n_{ix}(t)\):
\(E_{ix}(t) = p_{d}n_{ix}(t)\). The immigration probability at patch
\(x\) for species \(i\), \(\xi_{ix}(t)\), is calculated using the
following equation that accounts for separation distance among habitat
patches and dispersal capability of species:

\[
\xi_{ix}(t) = \frac{\sum_{y,y \neq x}E_{iy}(t)~exp(-\theta d_{xy})}{\sum_{x} \sum_{y,y \neq x}E_{iy}(t)~exp(-\theta d_{xy})}
\] where \(d_{xy}\) is the separation distance between patch \(x\) and
\(y\). The parameter \(\theta\) regulates the dispersal distance of
species that follows an exponential distribution (\(\theta^{-1}\)
corresponds to the expected dispersal distance). The expected number of
immigrants is calculated as
\(I_{ix}(t) = \xi_{ix}(t)\sum_x^{N_p} E_{ix}\).

\hypertarget{simulation}{%
\subsection{Simulation}\label{simulation}}

We used 32 sets of parameter combinations to produce different landscape
(four patterns of environmental heterogeneity) and ecological scenarios
(eight patterns of dispersal and competition). To create landscape
scenarios with different patterns of environmental heterogeneity, we
varied environmental variation at headwaters (\(\sigma_h\)) and the
degree of local environmental noise (\(\sigma_l\)) separately. Larger
values of \(\sigma_h\) and/or \(\sigma_l\) produce greater variation in
environmental conditions among habitat patches. We used two values for
each of the SD parameters (\(\sigma_h =\) 0.01, 1 and \(\sigma_l =\)
0.01, 1), resulting in four sets of parameter combinations. When
\(\sigma_h > \sigma_l\), having more tributaries in a network exhibits
important effects on environmental heterogeneity as branching is the
primary source of environmental variation. When
\(\sigma_h \le \sigma_l\), local environmental noise masks environmental
variation among tributaries, leading to minimal influences of branching
on environmental heterogeneity in a network. For ecological scenarios,
we varied three ecological parameters that are relevent for dispersal
and interspecific competition: dispersal distance (\(\theta =\) 0.1, 1),
dispersal probability (\(p_d =\) 0.01, 0.1), and the maximum value of
competition coefficients (\(\alpha_{max} =\) 0.75, 1.5). This results in
eight ecological scenarios with different levels of dispersal and
competition.

We used fixed values for the following parameters: maximum reproductive
number (\(r_{0,i} =\) 4), niche cost (\(\nu =\) 1), the degree of
temporal fluctuation in abiotic environments (\(\sigma_z =\) 0.1), and
the degree of spatial autocorrelation in temporal environmental dynamics
(\(\phi =\) 0.05).

\hypertarget{references}{%
\section*{References}\label{references}}
\addcontentsline{toc}{section}{References}

\hypertarget{refs}{}
\begin{cslreferences}
\leavevmode\hypertarget{ref-lomolinoEcologyMostGeneral2000a}{}%
1. Lomolino, M. V. Ecology's Most General, Yet Protean Pattern: The
Species-Area Relationship. \emph{Journal of Biogeography} \textbf{27},
17--26 (2000).

\leavevmode\hypertarget{ref-arrheniusSpeciesArea1921}{}%
2. Arrhenius, O. Species and Area. \emph{Journal of Ecology} \textbf{9},
95--99 (1921).

\leavevmode\hypertarget{ref-triantisIslandSpeciesArea2012}{}%
3. Triantis, K. A., Guilhaumon, F. \& Whittaker, R. J. The island
speciesArea relationship: Biology and statistics. \emph{Journal of
Biogeography} \textbf{39}, 215--231 (2012).

\leavevmode\hypertarget{ref-ben-hurDisentanglingMechanismsUnderlying2020}{}%
4. Ben-Hur, E. \& Kadmon, R. Disentangling the mechanisms underlying the
speciesArea relationship: A mesocosm experiment with annual plants.
\emph{Journal of Ecology} (2020).

\leavevmode\hypertarget{ref-kallimanisHowDoesHabitat2008a}{}%
5. Kallimanis, A. S. \emph{et al.} How does habitat diversity affect the
speciesArea relationship? \emph{Global Ecology and Biogeography}
\textbf{17}, 532--538 (2008).

\leavevmode\hypertarget{ref-hubbellUnifiedNeutralTheory2001}{}%
6. Hubbell, S. P. \emph{The Unified Neutral Theory of Biodiversity and
Biogeography}. (Princeton University Press, 2001).

\leavevmode\hypertarget{ref-lososTheoryIslandBiogeography2009}{}%
7. Losos, J. B. \& Ricklefs, R. E. \emph{The theory of island
biogeography revisited}. (Princeton University Press, 2009).

\leavevmode\hypertarget{ref-rinaldoEvolutionSelectionRiver2014}{}%
8. Rinaldo, A., Rigon, R., Banavar, J. R., Maritan, A. \&
Rodriguez-Iturbe, I. Evolution and selection of river networks: Statics,
dynamics, and complexity. \emph{Proceedings of the National Academy of
Sciences} \textbf{111}, 2417--2424 (2014).

\leavevmode\hypertarget{ref-rodriguez-iturbeFractalRiverBasins2001}{}%
9. RodrÃ­guez-Iturbe, I. \& Rinaldo, A. \emph{Fractal river basins:
Chance and self-organization}. (Cambridge University Press, 2001).

\leavevmode\hypertarget{ref-grantLivingBranchesPopulation2007}{}%
10. Grant, E. H. C., Lowe, W. H. \& Fagan, W. F. Living in the branches:
Population dynamics and ecological processes in dendritic networks.
\emph{Ecology Letters} \textbf{10}, 165--175 (2007).

\leavevmode\hypertarget{ref-rinaldoRiverNetworksEcological2018}{}%
11. Rinaldo, A., Gatto, M. \& Rodriguez-Iturbe, I. River networks as
ecological corridors: A coherent ecohydrological perspective.
\emph{Advances in Water Resources} \textbf{112}, 27--58.

\leavevmode\hypertarget{ref-tonkinRoleDispersalRiver2018}{}%
12. Tonkin, J. D. \emph{et al.} The role of dispersal in river network
metacommunities: Patterns, processes, and pathways. \emph{Freshwater
Biology} \textbf{63}, 141--163 (2018).

\leavevmode\hypertarget{ref-faganConnectivityFragmentationExtinction2002}{}%
13. Fagan, W. F. Connectivity, fragmentation, and extinction risk in
dendritic metapopulations. \emph{Ecology} \textbf{83}, 3243--3249
(2002).

\leavevmode\hypertarget{ref-grantUseMultipleDispersal2010}{}%
14. Grant, E. H. C., Nichols, J. D., Lowe, W. H. \& Fagan, W. F. Use of
multiple dispersal pathways facilitates amphibian persistence in stream
networks. \emph{Proceedings of the National Academy of Sciences}
\textbf{107}, 6936--6940 (2010).

\leavevmode\hypertarget{ref-teruiMetapopulationStabilityBranching2018}{}%
15. Terui, A. \emph{et al.} Metapopulation stability in branching river
networks. \emph{Proceedings of the National Academy of Sciences}
\textbf{115}, E5963--E5969 (2018).

\leavevmode\hypertarget{ref-altermattDiversityRiverineMetacommunities2013}{}%
16. Altermatt, F. Diversity in riverine metacommunities: A network
perspective. \emph{Aquatic Ecology} \textbf{47}, 365--377 (2013).

\leavevmode\hypertarget{ref-carraraComplexInteractionDendritic2014}{}%
17. Carrara, F., Rinaldo, A., Giometto, A. \& Altermatt, F. Complex
interaction of dendritic connectivity and hierarchical patch size on
biodiversity in river-like landscapes. \emph{American Naturalist}
\textbf{183}, 13--25 (2014).

\leavevmode\hypertarget{ref-carraraDendriticConnectivityControls2012}{}%
18. Carrara, F., Altermatt, F., Rodriguez-Iturbe, I. \& Rinaldo, A.
Dendritic connectivity controls biodiversity patterns in experimental
metacommunities. \emph{Proceedings of the National Academy of Sciences}
\textbf{109}, 5761--5766 (2012).

\leavevmode\hypertarget{ref-yeakelSynchronisationStabilityRiver2014a}{}%
19. Yeakel, J. D., Moore, J. W., GuimarÃ£es, P. R. \& Aguiar, M. A. M.
de. Synchronisation and stability in river metapopulation networks.
\emph{Ecology Letters} \textbf{17}, 273--283 (2014).

\leavevmode\hypertarget{ref-thompsonProcessbasedMetacommunityFramework2020}{}%
20. Thompson, P. L. \emph{et al.} A process-based metacommunity
framework linking local and regional scale community ecology.
\emph{Ecology Letters} (2020)
doi:\href{https://doi.org/10.1111/ele.13568}{10.1111/ele.13568}.

\leavevmode\hypertarget{ref-petersonModellingDendriticEcological2013}{}%
21. Peterson, E. E. \emph{et al.} Modelling dendritic ecological
networks in space: An integrated network perspective. \emph{Ecology
Letters} \textbf{16}, 707--719 (2013).

\leavevmode\hypertarget{ref-holtRoleBranchingMaintenance2018}{}%
22. Holt, G. \& Chesson, P. The role of branching in the maintenance of
diversity in watersheds. \emph{Freshwater Science} \textbf{37}, 712--730
(2018).

\leavevmode\hypertarget{ref-comteFishDispersalFlowing2018}{}%
23. Comte, L. \& Olden, J. D. Fish dispersal in flowing waters: A
synthesis of movement- and genetic-based studies. \emph{Fish and
Fisheries} \textbf{19}, 1063--1077 (2018).

\leavevmode\hypertarget{ref-radingerPatternsPredictorsFish2014}{}%
24. Radinger, J. \& Wolter, C. Patterns and predictors of fish dispersal
in rivers. \emph{Fish and Fisheries} \textbf{15}, 456--473 (2014).

\leavevmode\hypertarget{ref-rodriguezRestrictedMovementStream2002}{}%
25. RodrÃ­guez, M. A. Restricted movement in stream fish: The paradigm is
incomplete, not lost. \emph{Ecology} \textbf{83}, 1--13 (2002).

\leavevmode\hypertarget{ref-bendaNetworkDynamicsHypothesis2004}{}%
26. Benda, L. E. E. \emph{et al.} The network dynamics hypothesis: How
channel networks structure riverine habitats. \emph{Bioscience}
\textbf{54}, 413--427 (2004).

\leavevmode\hypertarget{ref-poffHomogenizationRegionalRiver2007}{}%
27. Poff, N. L., Olden, J. D., Merritt, D. M. \& Pepin, D. M.
Homogenization of regional river dynamics by dams and global
biodiversity implications. \emph{Proceedings of the National Academy of
Sciences} \textbf{104}, 5732--5737 (2007).

\leavevmode\hypertarget{ref-palmerEcologicalRestorationStreams2014}{}%
28. Palmer, M. A., Hondula, K. L. \& Koch, B. J. Ecological restoration
of streams and rivers: Shifting strategies and shifting goals.
\emph{Annual Review of Ecology, Evolution, and Systematics} \textbf{45},
247--269 (2014).

\leavevmode\hypertarget{ref-chaianunpornEvolutionaryResponsesClimate2015}{}%
29. Chaianunporn, T. \& Hovestadt, T. Evolutionary responses to climate
change in parasitic systems. \emph{Global Change Biology} \textbf{21},
2905--2916 (2015).
\end{cslreferences}

\end{document}
